
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://insper.github.io/supercomp/Teoria/profiling/">
      
      
        <link rel="prev" href="../flags-compilacao/">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.7">
    
    
      
        <title>Profiling - SuperComputação - 2025/1</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/printing.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
      <link rel="stylesheet" href="../../equipe.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#profiling" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="SuperComputação - 2025/1" class="md-header__button md-logo" aria-label="SuperComputação - 2025/1" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SuperComputação - 2025/1
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Profiling
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/insper/supercomp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SuperComp
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="SuperComputação - 2025/1" class="md-nav__button md-logo" aria-label="SuperComputação - 2025/1" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    SuperComputação - 2025/1
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/insper/supercomp" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    SuperComp
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Aulas
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Aulas
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aulas/01-introducao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atividade 01: Introdução a HPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aulas/02-introducao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atividade 02: Introdução ao Cluster Franky
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aulas/02-slurm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atividade 03: Exercicios de SLURM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aulas/03-cpp/aula-4.pdf" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atividade 04.1: Introdução ao C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aulas/03-cpp/03-cpp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atividade 04.2: Exercicios de C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aulas/04-Profiling/04-Profiling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atividade 05: Profiling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aulas/05-heuristicas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atividade 06: Problema da Mochila com Busca Exaustiva
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../aulas/06-aleatorizacao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Atividade 07: Problema da Mochila com Heurística Aleatória
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Teoria
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Teoria
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Materiais e Guias para estudo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contextualizando-hpc/contextualizando-HPC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contextualizando o HPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-Franky/cluster-Franky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Franky
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../slurm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SLURM
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../comandos-ssh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transferência de Arquivos entre sua máquina e o Cluster Franky
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introducao/conceitos-basicos-hw/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relembrando conceitos importantes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conceitos-basicos-C%2B%2B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conceitos básicos de C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../compilar-executar-C%2B%2B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compilar/Executar Códigos C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../loops-e-la%C3%A7os/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Loops e Laços
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../funcoes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Passagem de Parâmetros
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uso-de-constantes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Const Correctness em HPC
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../memoria-dinamica/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alocação de Memória Dinâmica
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sobrecarga-de-funcoes-C%2B%2B/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sobrecarga de Funções em C++
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../classes-e-objetos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Classes e objetos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../manipulacao-vetores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manipulação de Vetores
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flags-compilacao/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flags de compilação (-O1, -O2, -O3, -Ofast).
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Profiling
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Profiling
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ferramentas-para-profiling-em-c" class="md-nav__link">
    <span class="md-ellipsis">
      Ferramentas para Profiling em C++
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exemplo-1-usando-gprof" class="md-nav__link">
    <span class="md-ellipsis">
      Exemplo 1: Usando gprof
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exemplo 1: Usando gprof">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codigo-de-exemplo-em-c" class="md-nav__link">
    <span class="md-ellipsis">
      Código de Exemplo em C++
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compilacao-com-suporte-a-profiling" class="md-nav__link">
    <span class="md-ellipsis">
      Compilação com Suporte a Profiling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executando-o-programa" class="md-nav__link">
    <span class="md-ellipsis">
      Executando o Programa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analisando-os-dados-com-gprof" class="md-nav__link">
    <span class="md-ellipsis">
      Analisando os Dados com gprof
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entendendo-o-relatorio-de-profiling" class="md-nav__link">
    <span class="md-ellipsis">
      Entendendo o Relatório de Profiling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flat-profile-identificando-as-funcoes-criticas" class="md-nav__link">
    <span class="md-ellipsis">
      Flat Profile: Identificando as Funções Críticas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-graph-compreendendo-as-relacoes-entre-funcoes" class="md-nav__link">
    <span class="md-ellipsis">
      Call Graph: Compreendendo as Relações Entre Funções
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analise-do-relatorio-de-profiling" class="md-nav__link">
    <span class="md-ellipsis">
      Análise do Relatório de Profiling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Análise do Relatório de Profiling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#oportunidades-de-otimizacao" class="md-nav__link">
    <span class="md-ellipsis">
      Oportunidades de Otimização
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exemplo-2-usando-valgrind-para-profiling-de-memoria" class="md-nav__link">
    <span class="md-ellipsis">
      Exemplo 2: Usando Valgrind para Profiling de Memória
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exemplo 2: Usando Valgrind para Profiling de Memória">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usando-o-valgrind-para-detectar-problemas-de-memoria" class="md-nav__link">
    <span class="md-ellipsis">
      Usando o Valgrind para Detectar Problemas de Memória
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpretacao-do-relatorio-valgrind" class="md-nav__link">
    <span class="md-ellipsis">
      Interpretação do Relatório Valgrind
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interpretação do Relatório Valgrind">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usando-o-valgrind-para-profiling-de-cpu-com-callgrind" class="md-nav__link">
    <span class="md-ellipsis">
      Usando o Valgrind para Profiling de CPU com callgrind
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proximos-passos" class="md-nav__link">
    <span class="md-ellipsis">
      Próximos Passos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparacao-entre-gprof-e-valgrind" class="md-nav__link">
    <span class="md-ellipsis">
      Comparação entre Gprof e Valgrind
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusao" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusão
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ferramentas-para-profiling-em-c" class="md-nav__link">
    <span class="md-ellipsis">
      Ferramentas para Profiling em C++
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exemplo-1-usando-gprof" class="md-nav__link">
    <span class="md-ellipsis">
      Exemplo 1: Usando gprof
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exemplo 1: Usando gprof">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#codigo-de-exemplo-em-c" class="md-nav__link">
    <span class="md-ellipsis">
      Código de Exemplo em C++
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compilacao-com-suporte-a-profiling" class="md-nav__link">
    <span class="md-ellipsis">
      Compilação com Suporte a Profiling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executando-o-programa" class="md-nav__link">
    <span class="md-ellipsis">
      Executando o Programa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#analisando-os-dados-com-gprof" class="md-nav__link">
    <span class="md-ellipsis">
      Analisando os Dados com gprof
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entendendo-o-relatorio-de-profiling" class="md-nav__link">
    <span class="md-ellipsis">
      Entendendo o Relatório de Profiling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flat-profile-identificando-as-funcoes-criticas" class="md-nav__link">
    <span class="md-ellipsis">
      Flat Profile: Identificando as Funções Críticas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#call-graph-compreendendo-as-relacoes-entre-funcoes" class="md-nav__link">
    <span class="md-ellipsis">
      Call Graph: Compreendendo as Relações Entre Funções
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analise-do-relatorio-de-profiling" class="md-nav__link">
    <span class="md-ellipsis">
      Análise do Relatório de Profiling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Análise do Relatório de Profiling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#oportunidades-de-otimizacao" class="md-nav__link">
    <span class="md-ellipsis">
      Oportunidades de Otimização
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exemplo-2-usando-valgrind-para-profiling-de-memoria" class="md-nav__link">
    <span class="md-ellipsis">
      Exemplo 2: Usando Valgrind para Profiling de Memória
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Exemplo 2: Usando Valgrind para Profiling de Memória">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usando-o-valgrind-para-detectar-problemas-de-memoria" class="md-nav__link">
    <span class="md-ellipsis">
      Usando o Valgrind para Detectar Problemas de Memória
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpretacao-do-relatorio-valgrind" class="md-nav__link">
    <span class="md-ellipsis">
      Interpretação do Relatório Valgrind
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interpretação do Relatório Valgrind">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usando-o-valgrind-para-profiling-de-cpu-com-callgrind" class="md-nav__link">
    <span class="md-ellipsis">
      Usando o Valgrind para Profiling de CPU com callgrind
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proximos-passos" class="md-nav__link">
    <span class="md-ellipsis">
      Próximos Passos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparacao-entre-gprof-e-valgrind" class="md-nav__link">
    <span class="md-ellipsis">
      Comparação entre Gprof e Valgrind
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusao" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusão
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="profiling">Profiling<a class="headerlink" href="#profiling" title="Permanent link">&para;</a></h1>
<p>Profiling é o processo de medir o comportamento de um programa em termos de consumo de recursos, como tempo de execução, uso de CPU, memória e I/O. As informações coletadas durante o profiling ajudam a identificar "gargalos" ou partes do código que são ineficientes.</p>
<div class="admonition tip">
<p class="admonition-title">Use o Cluster Franky</p>
<div class="codehilite"><pre><span></span><code>Acessando o terminal dele via ssh com o comando ssh nome_da_pasta@ip_do_cluster
</code></pre></div>

</div>
<p><a href="../../aulas/01-introducao/">ficou com dúvida?</a></p>
<h3 id="ferramentas-para-profiling-em-c">Ferramentas para Profiling em C++<a class="headerlink" href="#ferramentas-para-profiling-em-c" title="Permanent link">&para;</a></h3>
<p><strong>gprof:</strong> O gprof (GNU Profiler) é uma ferramenta de profiling que faz parte do GNU Compiler Collection (GCC). Ele é usado para medir o tempo de execução gasto em cada função de um programa e criar um relatório detalhado de como esse tempo é distribuído entre as várias partes do código. O gprof é útil para identificar "gargalos" de desempenho em um programa, onde otimizações podem ser mais eficazes.</p>
<p><strong>Valgrind:</strong> O Valgrind é uma suíte de ferramentas que ajuda a encontrar bugs de memória e a realizar profiling de programas,também é usado para medir o desempenho do programa em termos de uso de CPU.</p>
<h3 id="exemplo-1-usando-gprof">Exemplo 1: Usando <code>gprof</code><a class="headerlink" href="#exemplo-1-usando-gprof" title="Permanent link">&para;</a></h3>
<p>Vamos começar com um exemplo básico de como usar o <code>gprof</code>.</p>
<h4 id="codigo-de-exemplo-em-c">Código de Exemplo em C++<a class="headerlink" href="#codigo-de-exemplo-em-c" title="Permanent link">&para;</a></h4>
<p>O código exemplo <em>mult_matriz.cpp</em> realiza uma operação de multiplicação de matrizes. Ele multiplica duas matrizes  <strong>A</strong>  e  <strong>B</strong>  e armazena o resultado na matriz <strong>C</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;vector&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">multiplyMatrices</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;&amp;</span><span class="w"> </span><span class="n">C</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">));</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">C</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">));</span>

<span class="w">    </span><span class="n">multiplyMatrices</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">);</span>

<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Matrix multiplication completed.&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="compilacao-com-suporte-a-profiling">Compilação com Suporte a Profiling<a class="headerlink" href="#compilacao-com-suporte-a-profiling" title="Permanent link">&para;</a></h4>
<p>Para usar o <code>gprof</code>, precisamos compilar o código com a flag <code>-pg</code>, que habilita o suporte ao profiling:</p>
<div class="highlight"><pre><span></span><code>g++<span class="w"> </span>-pg<span class="w"> </span>mult_matriz.cpp<span class="w"> </span>-o<span class="w"> </span>mult_matriz
</code></pre></div>
<h4 id="executando-o-programa">Executando o Programa<a class="headerlink" href="#executando-o-programa" title="Permanent link">&para;</a></h4>
<p>Depois de compilar, execute o programa normalmente:</p>
<div class="highlight"><pre><span></span><code>./mult_matriz
</code></pre></div>
<p>Essa execução vai gerar um arquivo chamado <code>gmon.out</code>, que contém os dados de profiling.</p>
<h4 id="analisando-os-dados-com-gprof">Analisando os Dados com <code>gprof</code><a class="headerlink" href="#analisando-os-dados-com-gprof" title="Permanent link">&para;</a></h4>
<p>Agora, use o <code>gprof</code> para analisar os dados:</p>
<div class="highlight"><pre><span></span><code>gprof<span class="w"> </span>mult_matriz<span class="w"> </span>gmon.out<span class="w"> </span>&gt;<span class="w"> </span>analise.txt
</code></pre></div>
<p>Isso cria um relatório detalhado do tempo gasto em cada função e a quantidade de chamadas feitas. O relatório será salvo no arquivo <code>analise.txt</code>.</p>
<h4 id="entendendo-o-relatorio-de-profiling">Entendendo o Relatório de Profiling<a class="headerlink" href="#entendendo-o-relatorio-de-profiling" title="Permanent link">&para;</a></h4>
<p>Após executar o seu programa com <code>gprof</code>, você obterá um relatório que contém duas seções principais: o <strong>Flat Profile</strong> e o <strong>Call Graph</strong>. Vamos explorar o significado de cada uma e como interpretá-las.</p>
<h4 id="flat-profile-identificando-as-funcoes-criticas">Flat Profile: Identificando as Funções Críticas<a class="headerlink" href="#flat-profile-identificando-as-funcoes-criticas" title="Permanent link">&para;</a></h4>
<p>O <strong>Flat Profile</strong> fornece uma visão geral do tempo que cada função consome durante a execução do programa. Aqui estão os principais elementos do relatório:</p>
<ul>
<li>
<p><strong>% time</strong>: Indica a porcentagem do tempo total de execução que foi gasto em cada função. Funções com valores mais altos são geralmente os principais alvos para otimização.</p>
</li>
<li>
<p><strong>cumulative seconds</strong>: É o tempo acumulado até essa função ser chamada. Ele ajuda a entender quanto tempo foi gasto no programa até aquele ponto.</p>
</li>
<li>
<p><strong>self seconds</strong>: É ao tempo gasto exclusivamente dentro da função, sem incluir o tempo das funções que ela chama.</p>
</li>
<li>
<p><strong>calls</strong>: Mostra quantas vezes a função foi chamada. Funções chamadas muitas vezes podem ser boas candidatas para otimização, especialmente se tiverem um tempo significativo por chamada.</p>
</li>
<li>
<p><strong>self ms/call</strong> e <strong>total ms/call</strong>: Esses valores mostram o tempo médio gasto em cada chamada da função. <code>self ms/call</code> é o tempo gasto na própria função, enquanto <code>total ms/call</code> inclui o tempo das funções que ela invoca.</p>
</li>
</ul>
<h4 id="call-graph-compreendendo-as-relacoes-entre-funcoes">Call Graph: Compreendendo as Relações Entre Funções<a class="headerlink" href="#call-graph-compreendendo-as-relacoes-entre-funcoes" title="Permanent link">&para;</a></h4>
<p>O <strong>Call Graph</strong> mostra a hierarquia de chamadas entre as funções do seu programa. Ele detalha como as funções estão interconectadas e qual o impacto de cada uma no tempo de execução total.</p>
<ul>
<li>
<p><strong>Self/Children Time</strong>: O tempo "Self" é o gasto na própria função, enquanto o tempo "Children" é o gasto nas funções que ela chama.</p>
</li>
<li>
<p><strong>Called</strong>: Informa quantas vezes uma função foi chamada, seja diretamente ou indiretamente por outras funções.</p>
</li>
</ul>
<h3 id="analise-do-relatorio-de-profiling">Análise do Relatório de Profiling<a class="headerlink" href="#analise-do-relatorio-de-profiling" title="Permanent link">&para;</a></h3>
<p>No relatório gerado, as funções relacionadas ao operador <code>operator[]</code> do <code>std::vector</code> aparecem como críticas, consumindo cerca de <strong>33%</strong> do tempo de execução cada. Isso indica que a maneira como os vetores são acessados e manipulados no código esta consumindo bastante tempo.</p>
<p>Além disso, a função <strong><code>multiplyMatrices</code></strong> aparece com um tempo de execução acumulado considerável. Como esta função realiza o trabalho pesado da multiplicação de matrizes, é natural que ela seja um foco de atenção para otimização.</p>
<h4 id="oportunidades-de-otimizacao">Oportunidades de Otimização<a class="headerlink" href="#oportunidades-de-otimizacao" title="Permanent link">&para;</a></h4>
<p>Com base no relatório, os possíveis candidatos a otimização são:</p>
<ul>
<li>
<p><strong>Reduzir Acessos ao Vetor</strong>: Como o acesso aos elementos do vetor (<code>operator[]</code>) consome uma parte significativa do tempo de execução, podemos tentar reduzir o número de acessos diretos ao vetor. </p>
</li>
<li>
<p><strong>Otimizar a Função <code>multiplyMatrices</code></strong>: Esta função é o coração do processamento e qualquer melhoria aqui terá um grande impacto no desempenho global. Podemos pensar em paralelizar a função para distribuir o trabalho entre múltiplos núcleos ou máquinas, em um ambiente HPC como o Cluster Franky.</p>
</li>
</ul>
<h3 id="exemplo-2-usando-valgrind-para-profiling-de-memoria">Exemplo 2: Usando Valgrind para Profiling de Memória<a class="headerlink" href="#exemplo-2-usando-valgrind-para-profiling-de-memoria" title="Permanent link">&para;</a></h3>
<p>O <strong>Valgrind</strong> tem um conjunto de ferramentas para análise de programas. Uma de suas funcionalidades mais conhecidas é a detecção de problemas de memória, mas também pode ser usado para profiling de CPU.</p>
<p>Vamos usar o mesmo código de multiplicação de matrizes do exemplo anterior.</p>
<h4 id="usando-o-valgrind-para-detectar-problemas-de-memoria">Usando o Valgrind para Detectar Problemas de Memória<a class="headerlink" href="#usando-o-valgrind-para-detectar-problemas-de-memoria" title="Permanent link">&para;</a></h4>
<p>Primeiro, compile o código normalmente, sem flags especiais:</p>
<div class="highlight"><pre><span></span><code>g++<span class="w"> </span>mult_matriz.cpp<span class="w"> </span>-o<span class="w"> </span>mult_matriz
</code></pre></div>
<p>Agora, execute o programa usando o <strong>Valgrind</strong> para detectar problemas de memória:</p>
<div class="highlight"><pre><span></span><code>valgrind<span class="w"> </span>--leak-check<span class="o">=</span>full<span class="w"> </span>./mult_matriz<span class="w"> </span><span class="p">&amp;</span>&gt;leak-check.txt
</code></pre></div>
<p>O Valgrind irá executar o programa e relatar quaisquer vazamentos de memória ou acessos inválidos no arquivo leak-check.txt.</p>
<p>No relatório obtido aqui nos meus testes eu tive os seguintes resultados:</p>
<h3 id="interpretacao-do-relatorio-valgrind">Interpretação do Relatório Valgrind<a class="headerlink" href="#interpretacao-do-relatorio-valgrind" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>HEAP SUMMARY (Resumo da Pilha)</strong></li>
<li>
<p><strong>in use at exit: 0 bytes in 0 blocks</strong>: Isso significa que, ao final da execução do programa, não há blocos de memória alocados que não foram liberados. Ou seja, toda a memória que foi alocada foi devidamente liberada.</p>
</li>
<li>
<p><strong>total heap usage: 308 allocs, 308 frees, 202,128 bytes allocated</strong>: Este campo indica que, ao longo da execução do programa, 308 alocações de memória <em>heap</em> ocorreram, e todas as 308 foram correspondidas por uma liberação. O total de memória alocada durante o programa foi de 202,128 bytes.</p>
</li>
<li>
<p><strong>All heap blocks were freed -- no leaks are possible</strong></p>
</li>
<li>
<p>Esta linha confirma que todos os blocos de memória foram liberados corretamente, portanto, não há vazamentos de memória possíveis. Isso significa que o gerenciamento de memória no programa está sendo feito corretamente.</p>
</li>
<li>
<p><strong>ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0)</strong></p>
</li>
<li>Esta parte do relatório informa que não houve nenhum erro de memória detectado. Isso inclui erros como acessos inválidos, uso de memória não inicializada, ou acessos fora dos limites. O Valgrind não encontrou nenhum problema relacionado à memória neste programa.</li>
</ol>
<h4 id="usando-o-valgrind-para-profiling-de-cpu-com-callgrind">Usando o Valgrind para Profiling de CPU com <code>callgrind</code><a class="headerlink" href="#usando-o-valgrind-para-profiling-de-cpu-com-callgrind" title="Permanent link">&para;</a></h4>
<p>O Valgrind também pode ser usado para profiling de CPU com a ferramenta <strong>Callgrind</strong>:</p>
<div class="highlight"><pre><span></span><code>valgrind<span class="w"> </span>--tool<span class="o">=</span>callgrind<span class="w"> </span>./mult_matriz<span class="w"> </span>
</code></pre></div>
<p>Este comando vai resultar em um arquivo de saída <code>callgrind.out.&lt;PID&gt;</code>, que contém informações detalhadas sobre o uso da CPU por cada função do programa.</p>
<p>O relatório que você executou com Callgrind fornece um resumo sobre o desempenho do programa em termos de <strong>instruções executadas</strong>. Os elementos principais do relatório são:</p>
<ol>
<li>
<p><strong>Events: Ir</strong>: <strong><code>Ir</code></strong> significa "Instruction References". Este evento conta o número total de instruções de máquina que foram executadas pelo programa. As instruções de máquina são as operações mais básicas que a CPU realiza, como somar números, carregar dados da memória, ou comparar valores. No relatório aqui do meu teste, o valor de <code>Ir</code> é <strong>128,306,660</strong>. Isso significa que o programa executou mais de 128 milhões de instruções durante a multiplicação de matrizes.</p>
</li>
<li>
<p><strong>Collected: 128,306,660</strong>: Este número indica que o Callgrind coletou dados sobre todas essas 128 milhões de instruções. É uma confirmação de que todas as instruções executadas foram monitoradas.</p>
</li>
<li>
<p><strong>I refs: 128,306,660</strong> : <strong><code>I refs</code></strong> é uma métrica que mostra o número total de referências de instrução que foram feitas durante a execução do programa. Como o valor é igual ao de <code>Ir</code>, isso indica que cada instrução foi contabilizada.</p>
</li>
</ol>
<p>O que fazer com essas informações?</p>
<ul>
<li>
<p><strong>Número de Instruções</strong>: Um alto número de instruções (<code>Ir</code>) pode indicar que o programa está realizando muitas operações. Em um ambiente HPC, isso pode ser bom ou ruim, dependendo da eficiência dessas instruções. Muitas instruções simples podem ser rápidas, enquanto poucas instruções complexas podem ser mais lentas.</p>
</li>
<li>
<p><strong>Identificação de Gargalos</strong>: Ao combinar esses dados com outras informações, como tempos de execução e cache misses (que Callgrind também pode monitorar), você pode identificar quais partes do código consomem mais recursos e otimizar essas áreas. Por exemplo, se uma função específica estiver gerando um grande número de instruções e utilizando muito cache, ela pode ser um gargalo que precisa ser otimizado.</p>
</li>
</ul>
<h3 id="proximos-passos">Próximos Passos<a class="headerlink" href="#proximos-passos" title="Permanent link">&para;</a></h3>
<p>Para uma análise mais detalhada, você pode:</p>
<p>Usar o <strong>KCachegrind</strong> (uma interface gráfica) para visualizar o resultado detalhadamente:</p>
<div class="highlight"><pre><span></span><code>kcachegrind<span class="w"> </span>callgrind.out.&lt;PID&gt;
</code></pre></div>
<p><img alt="callgrind.out" src="../imgs/valgrind.png" /></p>
<p>Como podemos ver na imagem, a função <strong><code>multiplyMatrices</code></strong> está destacada em laranja e consome <strong>97.80%</strong> do total de instruções. Isso indica que a multiplicação de matrizes é a operação mais intensiva e crítica em termos de desempenho no código. Como essa função domina o uso de CPU, ela é o principal alvo para otimização.</p>
<p>As funções que manipulam <code>std::vector</code> também aparecem com destaque:</p>
<p><strong><code>std::vector::operator[]</code></strong>: Consome <strong>18.71%</strong> das instruções. Esse operador é chamado cada vez que um elemento do vetor é acessado. A alta porcentagem indica que muitos acessos ao vetor estão ocorrendo, o que pode ser um ponto de otimização.</p>
<p><strong><code>std::vector::allocator</code></strong>: Também está destacada, indicando que a alocação e acesso aos elementos do vetor é um fator importante no uso de recursos.</p>
<h3 id="comparacao-entre-gprof-e-valgrind">Comparação entre Gprof e Valgrind<a class="headerlink" href="#comparacao-entre-gprof-e-valgrind" title="Permanent link">&para;</a></h3>
<p><strong>Gprof</strong> e <strong>Valgrind</strong> são ferramentas de profiling, mas com focos e funcionalidades especificas. Na tabela temos uma comparação detalhada entre essas duas ferramentas:</p>
<table>
<thead>
<tr>
<th><strong>Aspecto</strong></th>
<th><strong>Gprof</strong></th>
<th><strong>Valgrind</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Foco Principal</strong></td>
<td>Profiling de desempenho, medindo o tempo gasto em funções.</td>
<td>Detecta erros de uso de memória e oferece ferramentas de profiling.</td>
</tr>
<tr>
<td><strong>Uso Típico</strong></td>
<td>Mapear gargalos de desempenho e identificar o tempo de execução das funções.</td>
<td>Detectar vazamentos de memória, acessos inválidos, e mapear o uso de CPU e memória.</td>
</tr>
<tr>
<td><strong>Complexidade</strong></td>
<td>Relativamente simples de usar e interpretar, adequado para profiling inicial.</td>
<td>Mais complexo, com várias ferramentas especializadas para diferentes tipos de análise.</td>
</tr>
<tr>
<td><strong>Overhead de Execução</strong></td>
<td>Baixo overhead; o programa roda quase na velocidade normal.</td>
<td>Alto overhead; o programa pode rodar significativamente mais lento devido à análise detalhada.</td>
</tr>
<tr>
<td><strong>Análise de Funções</strong></td>
<td>Oferece relatórios de chamadas (Call Graph) e perfis de funções para entender o tempo de execução.</td>
<td>Oferece gráficos de chamadas detalhados com Callgrind, além de perfis de cache e instruções.</td>
</tr>
<tr>
<td><strong>Depuração de Memória</strong></td>
<td>Não fornece suporte para debug de memória.</td>
<td>Ferramenta principal para depuração de memória, com suporte para detectar vazamentos e erros.</td>
</tr>
<tr>
<td><strong>Multithreading</strong></td>
<td>Suporta análise básica, mas não é especializado em detectar race conditions.</td>
<td>Helgrind é especializado race conditions em programas multithreaded.</td>
</tr>
<tr>
<td><strong>Integração e Uso</strong></td>
<td>Parte do GCC, fácil de integrar em fluxos de trabalho de compilação.</td>
<td>Requer execução com a ferramenta específica e pode necessitar de ajustes no ambiente para uso eficiente.</td>
</tr>
<tr>
<td><strong>Ambiente de Uso</strong></td>
<td>Ideal para profiling em ambientes de desenvolvimento e produção.</td>
<td>Melhor utilizado em desenvolvimento e testes devido ao overhead; útil em produção para análise pontual.</td>
</tr>
</tbody>
</table>
<h3 id="conclusao">Conclusão<a class="headerlink" href="#conclusao" title="Permanent link">&para;</a></h3>
<p><strong>Gprof</strong> e <strong>Valgrind</strong> são ferramentas complementares no arsenal de um desenvolvedor:</p>
<ul>
<li>
<p><strong>Gprof</strong> é uma boa escolha quando o objetivo é entender a distribuição de tempo de execução entre as funções de um programa. Com seu baixo overhead, é ideal para profiling inicial e para identificar rapidamente as áreas do código que mais consomem tempo.</p>
</li>
<li>
<p><strong>Valgrind</strong> é indispensável quando se trata de garantir o bom funcionamento do código, especialmente em relação ao uso de memória. Embora introduza um overhead significativo, suas ferramentas como <strong>Memcheck</strong> e <strong>Callgrind</strong> são essenciais para detectar vazamentos de memória, acessos inválidos, e para visualizar o desempenho em termos de uso de CPU e cache.</p>
</li>
</ul>
<p>Em ambientes de HPC, usar <strong>Gprof</strong> para identificar gargalos de desempenho e <strong>Valgrind</strong> para garantir que o código esteja livre de erros de memória e bem otimizado, proporciona uma abordagem robusta para garantir que o software seja tanto rápido quanto confiável. </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.0.0/js-yaml.min.js"></script>
      
        <script src="../../js/markdown-enhancer.js"></script>
      
        <script src="../../js/slides.js"></script>
      
    
  </body>
</html>